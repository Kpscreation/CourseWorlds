<th:block th:insert="~{Admin/fragments/Header}" />
<!-- Navbar -->
<th:block th:insert="~{Admin/fragments/Navbar}" />
<!-- Sidebar -->
<th:block th:insert="~{Admin/fragments/Sidebar}" />

<!-- Content Wrapper -->
<div class="content-wrapper">
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1>Users</h1>
        </div>
      </div>
    </div>
  </section>

  <!-- Main content -->
  <section class="content">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">List Of Users</h3>
        <div class="card-tools">
          <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
            <i class="fas fa-minus"></i>
          </button>
          <button type="button" class="btn btn-tool" data-card-widget="remove" title="Remove">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <div class="card-body p-0">
        <!-- Success/Error Message with Close Button -->
        <div th:if="${message}" 
             th:classappend="${message == 'User is already verified!' ? 'alert-danger' : 'alert-info'}" 
             class="alert alert-dismissible fade show">
          <span th:text="${message}"></span>
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <table class="table table-striped projects">
          <thead>
            <tr>
              <th style="width: 1%">ID</th>
              <th style="width: 20%">Name</th>
              <th style="width: 20%">Email</th>
              <th style="width: 20%">Phone</th>
              <th style="width: 20%">Address</th>
              <th style="width: 20%">Admin Verified</th>
              <th style="width: 20%">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="user : ${users}">
              <td th:text="${user.user_id}"></td>
              <td th:text="${user.name}"></td>
              <td th:text="${user.email}"></td>
              <td th:text="${user.phone}"></td>
              <td th:text="${user.address}"></td>
              <td th:text="${user.adminVerified ? 'Verified' : 'Blocked'}"></td>
              <td class="project-actions text-right">
                <form th:action="@{/Admin/VerifyUser}" method="post">
                  <input type="hidden" name="userId" th:value="${user.user_id}">
                  <button type="submit" 
                          th:text="${user.adminVerified ? 'Block' : 'Verify'}" 
                          th:classappend="${user.adminVerified ? 'btn-danger' : 'btn-primary'}" 
                          class="btn fw-bold px-4 py-2">
                  </button>
                </form>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </section>
</div>

<th:block th:insert="~{Admin/fragments/Footer}" />
